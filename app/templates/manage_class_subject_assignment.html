{% extends "base.html" %}
{% block title %}Class Subject Assignment{% endblock %}
{% block content %}

<div class="card p-3 mb-3 page-title d-flex align-items-center">
    <div style="flex:1">
        <h2 class="mb-0">Class–Subject–Teacher Assignments</h2>
        <p class="text-muted small">Manage which teacher is assigned to teach each subject in each class.</p>
    </div>
    <div>
        <a class="btn btn-success" href="{{ url_for('main.add_teacher_class_subject') }}">
            Add Assignment
        </a>
    </div>
</div>

<div class="card p-3 mb-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <input id="searchInput" class="form-control" style="max-width:360px" placeholder="Search assignment...">
        <div>
            <label class="small text-muted me-2">Per page</label>
            <select id="perPage" class="form-select d-inline-block" style="width:80px">
                <option>5</option>
                <option selected>10</option>
                <option>25</option>
            </select>
        </div>
    </div>

    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>S/N</th>
                    <th>Class Name</th>
                    <th>Subject Name</th>
                    <th>Teacher Name</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="assignmentsTable">
                {% for csb in class_subject_assignments %}
                <tr
                    data-search="{{ csb.classroom.name }} {{ csb.subject.name }} {{ csb.teacher.first_name }} {{ csb.teacher.last_name }}">
                    <td>{{ loop.index }}</td>
                    <td>{{ csb.classroom.name }}</td>
                    <td>{{ csb.subject.name }} <small class="text-muted">({{ csb.subject.code }})</small></td>
                    <td>{{ csb.teacher.first_name }} {{ csb.teacher.last_name }}</td>
                    <td>
                        <a class="btn btn-sm btn-primary"
                            href="{{ url_for('main.edit_class_subject_assignment', assignment_id=csb.id) }}">
                            Edit
                        </a>

                        <form id="delete-csb-{{ csb.id }}"
                            action="{{ url_for('main.delete_class_subject_assignment', assignment_id=csb.id) }}"
                            method="post" style="display:inline;">
                            <button type="button" class="btn btn-sm btn-danger"
                                onclick="confirmDelete('delete-csb-{{ csb.id }}','Delete this assignment?')">
                                Delete
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="pager"></div>
{% endblock %}

<!-- Search Styling -->
<style>
    .search-input {
        width: 100%;
        max-width: 380px;
        padding: 14px 18px;
        font-size: 15px;
        color: #1f2937;
        background: linear-gradient(to bottom right, #fafafa, #f3f4f6);
        border: 1px solid #d1d5db;
        border-radius: 12px;
        outline: none;
        transition: all 0.25s ease;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.04);
    }

    .search-input:focus {
        background: #fff;
        border-color: #2563eb;
        box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.18),
            inset 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    .search-input:hover:not(:focus) {
        background: #fff;
        border-color: #93c5fd;
    }

    .search-input::placeholder {
        color: #9ca3af;
        font-style: italic;
        opacity: 0.8;
    }

    .search-input:focus::placeholder {
        opacity: 0.4;
    }
</style>

</div>