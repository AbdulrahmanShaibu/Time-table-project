{% extends "base.html" %}
{% block title %}Timetables{% endblock %}
{% block content %}
<div class="card page-title">
    <div style="
    display:flex;align-items:flex-start;gap:18px;
    background:#fff;border:1px solid #e6e8ec;border-left:5px solid #dc2626;
    padding:22px 24px;border-radius:14px;
    box-shadow:0 4px 10px rgba(0,0,0,0.05);margin-bottom:22px;
">
        <div style="
      background:#dc2626;width:48px;height:48px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 3px 8px rgba(220,38,38,0.3);
  ">
            <svg xmlns='http://www.w3.org/2000/svg' width='26' height='26' stroke='#fff' fill='none' stroke-width='2'>
                <rect x="3" y="4" width="18" height="18" rx="2" />
                <line x1="3" y1="10" x2="21" y2="10" />
                <line x1="8" y1="4" x2="8" y2="2" />
                <line x1="16" y1="4" x2="16" y2="2" />
            </svg>
        </div>

        <div>
            <h1 style="margin:0;font-size:24px;font-weight:700;color:#111827;">Timetable Management</h1>
            <p style="margin:8px 0 0;font-size:15px;color:#4b5563;line-height:1.6;">
                Automatically generate and manage school timetables. Assign teachers, rooms, subjects, and periods
                efficiently with conflict detection.
            </p>
        </div>
    </div>

    <div class="controls">
        <a class="btn btn-success" href="{{ url_for('main.add_timetable') }}">Add Entry</a>
    </div>
</div>

<div class="card table-wrap">
    <div style="display:flex;justify-content:space-between;align-items:center">
        <input class="search-input" placeholder="Search timetable..." />
        <div>
            <label class="small-muted">Per page</label>
            <select class="select-page">
                <option>5</option>
                <option selected>10</option>
                <option>25</option>
            </select>
        </div>
    </div>

    <table class="table data-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Class</th>
                <th>Subject</th>
                <th>Teacher</th>
                <th>Room</th>
                <th>Day</th>
                <th>Start</th>
                <th>End</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for tt in timetables %}
            <tr>
                <td>{{ tt.id }}</td>
                <td>{{ tt.class_subject_assignment.classroom.name }}</td>
                <td>{{ tt.class_subject_assignment.subject.name }}</td>
                <td>{{ tt.class_subject_assignment.teacher.full_name }}</td>
                <td>{{ tt.room.name }}</td>
                <td>{{ tt.day_of_week }}</td>
                <td>{{ tt.start_time.strftime('%H:%M') }}</td>
                <td>{{ tt.end_time.strftime('%H:%M') }}</td>
                <td>
                    <a class="btn btn-primary" href="{{ url_for('main.edit_timetable', timetable_id=tt.id) }}">Edit</a>
                    <form id="delete-timetable-{{ tt.id }}"
                        action="{{ url_for('main.delete_timetable', timetable_id=tt.id) }}" method="post"
                        style="display:inline">
                        <button type="button" class="btn btn-danger"
                            onclick="confirmDelete('delete-timetable-{{ tt.id }}','Delete this timetable entry?')">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="pager"></div>

    <style>
        .search-input {
            width: 100%;
            max-width: 380px;
            padding: 14px 18px;
            font-size: 15px;
            color: #1f2937;
            /* Neutral dark text */
            background: linear-gradient(to bottom right, #fafafa, #f3f4f6);

            border: 1px solid #d1d5db;
            border-radius: 12px;

            outline: none;
            transition: all 0.25s ease;

            /* Subtle inner shadow for a polished effect */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.04);
        }

        .search-input:focus {
            background: #ffffff;

            border-color: #2563eb;
            /* Deep professional blue */
            box-shadow:
                0 0 0 4px rgba(37, 99, 235, 0.18),
                /* Outer glow */
                inset 0 1px 3px rgba(0, 0, 0, 0.05);
            /* Retain inner shadow */
        }

        .search-input:hover:not(:focus) {
            background: #ffffff;
            border-color: #93c5fd;
            /* Soft hover highlight */
        }

        .search-input::placeholder {
            color: #9ca3af;
            font-style: italic;
            opacity: 0.8;
        }

        /* Optional: smooth placeholder transition */
        .search-input:focus::placeholder {
            opacity: 0.4;
            transition: opacity 0.2s ease;
        }
    </style>
</div>
{% endblock %}